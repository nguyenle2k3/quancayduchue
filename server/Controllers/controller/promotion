const Promotion = require('../../Models/models/promotion');
const asyncHandler = require('express-async-handler');
const slugify = require('slugify');

const createPromotion = asyncHandler(async (req, res) => {
    const { title, description, startTime, endTime } = req.body;
    startTime = new Date(startTime);
    endTime = new Date(endTime);
    console.log(startTime, endTime);
    // if (!title || !description || !startTime || !endTime) {
    //     return res.status(400).json({
    //         success: false,
    //         mes: 'Missing inputs',
    //     });
    // }
    req.body.slug = slugify(req.body.title, { replacement: '', lower: true });
    req.body.promotionid = req.body.slug;
    const newPromotion = await Promotion.create(req.body);
    return res.status(200).json({
        success: newPromotion ? true : false,
        mes: newPromotion ? 'Successsfully ! ' : 'Somethings went wrong :(',
    });
});

module.exports = {
    createPromotion,
};
